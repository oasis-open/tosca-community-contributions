tosca_definitions_version: tosca_2_0

profile: community.tosca.core:0.1

description: >-
  TOSCA Community Core Profile type definitions. These definitions are
  intended to be shared between profiles of all levels of abstraction.

data_types:
  json:
    description: >-
      The json type defines a string that contain data in the JSON
      format
    derived_from: string
    #validation: TBD (may need custom functions)
  yaml:
    description: >-
      The yaml type defines a string that contain data in the YAML
      format
    derived_from: string
    #validation: TBD (may need custom functions)
  ipv4:
    description: >-
      The ipv4 type defines a string that contain an IPv4 address
    derived_from: string
    validation: { $matches: [ $value, "^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" ] }
  port:
    description: >-
      The port type defines integer that contain valid ports
    derived_from: integer
    validation: { $in_range: [ $value, [ 0, 0xFFFF ] ] }
  ipv4Socket:
    description: >-
      This complex type represents an IPv4 socket (address+port)
    properties:
      ip-address:
        type: ipv4
      transport-port:
        type: port
  genericId:
    description: >-
      The genericId type represents a generic string identifier. It can be used to
      derive specific types, by adding proper validation
    derived_from: string
  alphanumericId:
    description: >-
      The alphanumericId type represents an alphanumeric type of arbitrary length
      made up only by digits and uppercase/lowercase letters
    derived_from: genericId
    validation: { $matches: [ $value, "^[A-Za-z0-9]+$" ] }
  uuid:
    description: >-
      The uuid type represents an IETF RFC4122 compliant universal identifier (types 1-5)
    derived_from: genericId
    validation: { $matches: [ $value, "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$" ] }
  uuidRelaxed:
    description: >-
      The uuidRelaxed type represents an identifier with format 8-4-4-4-12 (hex digits with dashes),
      but without full compliance to IETF RFC4122
    derived_from: genericId
    validation: { $matches: [ $value, "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$" ] }

relationship_types:
  Root: 
    description: >-
      Base relationship type from which all other relationship types
      derived. This is intended to hold an interface definition that
      is shared by all relationship types.
    metadata:
      relationship_kind: ASSOCIATION
  ContainedBy:
    description: >-
      The ContainedBy type represents a containment relationship between
      two nodes.
    metadata:
      relationship_kind: CONTAINMENT
    derived_from: Root
    valid_capability_types: [Container]
  DependsOn:
    description: >-
      Generic dependency on a feature
    metadata:
      relationship_kind: DEPENDENCY
    valid_capability_types: [Feature]
    derived_from: Root
  AssociatesWith:
    description: >-
      The AssociatesWith type represents an association relationship between
      two nodes.
    metadata:
      relationship_kind: ASSOCIATION
    derived_from: Root
    valid_capability_types: [Partner]

capability_types:
  Container:
    description: >-
      Base capability type for capabilities that can be targeted by a
      ContainedBy relationship.  Advertizes the ability to contain one
      or more other nodes.
    valid_relationship_types: [ContainedBy]
  Feature:
    description: >-
      Base capability type for capabilities that can be targeted by a
      DependsOn relationship. Derived types define
      application-specific functionality.
    valid_relationship_types: [DependsOn]
  Partner:
    description: >-
      Base capability type for capabilities that can be targeted by an
      AssociatesWith relationship.
    valid_relationship_types: [AssociatesWith]
    
functions:
  to_string:
    description: >-
      Convert an integer to string 
    signatures:
      - arguments:
          - type: integer
            description: >-
              The integer to convert to string
        result: string
        implementation: functions.string:to_string
  to_uppercase:
    description: >-
      Convert a string to upper case
    signatures:
      - arguments:
          - type: string
            description: >-
              The string to convert to upper case.
        result: string
        implementation: functions.string:to_uppercase
